<!DOCTYPE html>
<html lang="es">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Teleprompter Profesional</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>

body{
margin:0;
background:black;
color:white;
font-family:Inter;
overflow:hidden;
}

video{
position:fixed;
width:100%;
height:100%;
object-fit:cover;
z-index:1;
}

#textoContainer{

position:absolute;
bottom:-200px;
width:100%;
text-align:center;
z-index:2;
pointer-events:none;

}

.linea{

opacity:0;
font-weight:600;
margin:10px;
transition:opacity 0.6s;

}

.panel{

position:fixed;
bottom:0;
width:100%;
background:#111;
padding:10px;
z-index:3;

}

textarea{

width:100%;
height:80px;
font-size:16px;
}

button{

padding:10px 15px;
font-size:16px;
border-radius:8px;
border:none;
background:#007aff;
color:white;
margin:5px;

}

#stopBtn{
display:none;
background:red;
}

.sliderVertical{

position:fixed;
right:10px;
top:30%;
height:200px;
z-index:3;
}

input[type=range]{
writing-mode: bt-lr;
-webkit-appearance: slider-vertical;
height:200px;
}

#preview{

position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:black;
display:none;
z-index:5;

}

#preview video{
width:100%;
height:90%;
}

#guardarBtn{
background:green;
}

</style>
</head>

<body>

<video id="camara" autoplay muted playsinline></video>

<div id="textoContainer"></div>

<div class="sliderVertical">

<input type="range"
id="sizeSlider"
min="30"
max="120">

</div>

<div class="panel" id="panel">

<textarea id="texto"></textarea>

<br>

Velocidad
<input type="range"
id="velocidad"
min="20"
max="100"
value="50">

<br>

<button onclick="grabar()">
Grabar
</button>

</div>


<button id="stopBtn"
onclick="detener()">
STOP
</button>


<div id="preview">

<video id="videoPreview"
controls></video>

<br>

<button id="guardarBtn"
onclick="guardarVideo()">
Guardar Video
</button>

</div>


<script>

let stream;
let recorder;
let chunks=[];
let velocidad=50;
let fontSize=60;

const textoInput=document.getElementById("texto");
const velocidadSlider=document.getElementById("velocidad");
const sizeSlider=document.getElementById("sizeSlider");


// RESTAURAR CONFIG

textoInput.value=localStorage.getItem("texto")||"";
velocidadSlider.value=localStorage.getItem("velocidad")||50;
sizeSlider.value=localStorage.getItem("size")||60;


// GUARDAR CONFIG

textoInput.oninput=()=>localStorage.setItem("texto",textoInput.value);
velocidadSlider.oninput=()=>{
velocidad=velocidadSlider.value;
localStorage.setItem("velocidad",velocidad);
}

sizeSlider.oninput=()=>{

fontSize=sizeSlider.value;

localStorage.setItem("size",fontSize);

document.querySelectorAll(".linea")
.forEach(l=>l.style.fontSize=fontSize+"px");

}



// CAMARA

navigator.mediaDevices.getUserMedia({

video:{
width:1920,
height:1080
},

audio:true

})

.then(s=>{

stream=s;

document
.getElementById("camara")
.srcObject=s;

});



// TELEPROMPTER

function iniciarTexto(){

const container=
document.getElementById("textoContainer");

container.innerHTML="";

const palabras=
textoInput.value.split(" ");

let i=0;

setInterval(()=>{

container.innerHTML="";

for(let j=0;j<3;j++){

if(!palabras[i+j])break;

let div=
document.createElement("div");

div.className="linea";

div.style.fontSize=fontSize+"px";

div.innerText=
palabras[i+j];

container.appendChild(div);

}

setTimeout(()=>{

document
.querySelectorAll(".linea")
.forEach(l=>l.style.opacity=1);

},50);


i++;

container.style.bottom=
(parseInt(container.style.bottom||-200)+5)
+"px";


},150-velocidad);

}



// GRABAR

function grabar(){

document
.getElementById("panel")
.style.display="none";

document
.querySelector(".sliderVertical")
.style.display="none";

document
.getElementById("stopBtn")
.style.display="block";


chunks=[];

let options={
mimeType:"video/mp4"
};

try{

recorder=
new MediaRecorder(stream,options);

}catch{

recorder=
new MediaRecorder(stream);

}


recorder.ondataavailable=e=>chunks.push(e.data);

recorder.onstop=()=>{

let blob=
new Blob(chunks,{type:"video/mp4"});

let url=
URL.createObjectURL(blob);

document
.getElementById("preview")
.style.display="block";

document
.getElementById("videoPreview")
.src=url;

window.videoBlob=blob;

};


recorder.start();

iniciarTexto();

}



// STOP

function detener(){

recorder.stop();

document
.getElementById("stopBtn")
.style.display="none";

}



// GUARDAR

function guardarVideo(){

let a=document.createElement("a");

a.href=
URL.createObjectURL(window.videoBlob);

a.download=
"teleprompter.mp4";

a.click();

}


</script>

</body>
</html>
